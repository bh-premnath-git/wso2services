# WSO2 API Manager + Identity Server Architecture
## Complete Integration & Flow Documentation

---

## ğŸ“Š System Overview

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        WSO2 ECOSYSTEM ARCHITECTURE                       â•‘
â•‘                     API Manager 4.5 + Identity Server 7.1                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸ–¥ï¸  HOST MACHINE                           â”‚
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ› ï¸  WSO2 Toolkit Script (wso2-toolkit.sh)                    â”‚    â”‚
â”‚  â”‚  â€¢ Health checks                                              â”‚    â”‚
â”‚  â”‚  â€¢ Key Manager setup                                          â”‚    â”‚
â”‚  â”‚  â€¢ Application management                                     â”‚    â”‚
â”‚  â”‚  â€¢ Token generation                                           â”‚    â”‚
â”‚  â”‚  â€¢ Certificate management                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â”‚ HTTPS/REST API                           â”‚
â”‚                              â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    ğŸ³ DOCKER NETWORK                           â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚  ğŸŒ WSO2 API Manager (wso2am)                           â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  Port: 9443 (Management) | 8243 (Gateway)               â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸ“± Publisher Portal                               â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ API Design & Publishing                         â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Lifecycle Management                            â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸª Developer Portal (DevPortal)                   â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Application Management â­                       â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ API Subscription                                â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ OAuth2 Key Generation                           â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸ” Key Manager Integration                        â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ DCR (Dynamic Client Registration)              â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Token Validation                                â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Multi-KM Support                                â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸšª API Gateway                                    â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Request Routing                                 â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ JWT Validation (JWKS)                           â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Throttling & Rate Limiting                      â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Analytics & Monitoring                          â”ƒ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                       â”‚ MTLS (Mutual TLS)                 â”‚    â”‚
â”‚  â”‚                       â”‚ Certificate Trust                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ”‘ WSO2 Identity Server (wso2is)                   â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  Port: 9444 (External) | 9443 (Internal)            â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                       â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸŸï¸  OAuth2 Authorization Server                 â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Token Endpoint (/oauth2/token)                â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Authorization Endpoint                         â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Introspection & Revocation                     â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ JWKS Endpoint (/oauth2/jwks)                   â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                       â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸ“‹ DCR API (Dynamic Client Registration)        â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ /api/identity/oauth2/dcr/v1.1/register        â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ Client Management                             â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                       â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  ğŸ‘¥ SCIM2 API (User & Role Management)          â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ /scim2/Users                                  â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”ƒ  â€¢ /scim2/Roles                                  â”ƒ  â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›  â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ—„ï¸  PostgreSQL Database (postgres-wso2)          â”‚ â”‚    â”‚
â”‚  â”‚  â”‚                                                     â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  apim_db     â”‚  â”‚ identity_db  â”‚  â”‚shared_db â”‚ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚          â”‚ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ AM Apps    â”‚  â”‚ â€¢ IS Users   â”‚  â”‚ â€¢ Common â”‚ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ APIs       â”‚  â”‚ â€¢ Roles      â”‚  â”‚ â€¢ Config â”‚ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ Subscript. â”‚  â”‚ â€¢ OAuth2 Cli â”‚  â”‚          â”‚ â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```